---
page_type: sample
products:
- office-outlook
- office-365
languages:
- javascript
extensions:
  contentType: samples
  technologies:
  - Add-ins
  createdDate: 3/20/2017 11:55:13 PM
---
# Пример кода надстройки Outlook для проверки при отправке

Узнайте, как проверить текст электронного сообщения Outlook на наличие запрещенных слов, добавить получателя в строку "Копия" и убедиться, что при отправке задана тема сообщения.

>**Примечание.** 

* В настоящее время функция проверки при отправке поддерживается только для Outlook в Интернете из Office 365. 
* Подробнее о функции проверки при отправке можно прочитать в статье [Функция проверки при отправке для надстроек Outlook](https://dev.office.com/docs/add-ins/outlook/outlook-on-send-addins).  
* Разбор кода приведен в разделе [Примеры кода](https://docs.microsoft.com/en-us/outlook/add-ins/outlook-on-send-addins#code-examples).

## Содержание
* [Журнал изменений](#change-history)
* [Предварительные требования](#prerequisites)
* [Настройка и установка образца](#configure)
* [Отправка манифестов](#manifests)
* [Запуск надстройки](#test-the-add-in)
* [Вопросы и комментарии](#questions-and-comments)
* [Дополнительные ресурсы](#additional-resources)

## Журнал изменений

Апрель 2017 г.

* Исходная версия.

## Предварительные требования

* Надежный веб-сервер для размещения примеров файлов. Сервер должен иметь возможность принимать запросы, защищенные SSL (https), и иметь действительный сертификат SSL.
* Учетная запись почты Office 365.
* Включить функцию проверки при отправке (по умолчанию эта функция отключена). Надстройки для Outlook в Интернете, использующие функцию проверки при отправке, будут запускаться у пользователей, которым назначена политика почтовых ящиков Outlook в Интернете с флагом **OnSendAddinsEnabled**, имеющим значение **true**. Администраторы могут включить эту функцию с помощью командлетов Exchange Online PowerShell. Чтобы узнать, какие командлеты следует запускать, обратитесь к статье [Установка надстроек Outlook, использующих функцию проверки при отправке](https://docs.microsoft.com/en-us/outlook/add-ins/outlook-on-send-addins#installing-outlook-add-ins-that-use-on-send)

## Настройка и установка примера

1. Загрузите или разветвите репозиторий.
2. Откройте файл app.js. В функции `addCCOnSend` вместо `Contoso@contoso.onmicrosoft.com` вставьте ваш адрес электронной почты.
2. Разверните файлы надстроек в каталог на веб-сервере. Это файлы app.js и index.html.
3. Откройте файлы манифеста `Contoso Message Body Checker.xml` и `Contoso Subject and CC Checker.xml` в текстовом редакторе. Замените все вхождения `https://localhost:3000` HTTPS URL-адресом каталога, в который вы загрузили файлы на предыдущем шаге. Сохраните изменения.

   >  Дополнительные сведения
   * о запуске надстроек Outllook можно найти в статье [Запуск надстройки Outlook в учетной записи Office 365](https://dev.outlook.com/MailAppsGettingStarted/GetStarted)
   * о манифестах можно найти в статье [Манифесты надстроек Outlook](https://dev.office.com/docs/add-ins/outlook/manifests/manifests)

## Отправка манифестов

1. Войдите в [Outlook Web App](https://outlook.office365.com).
2. Щелкните **Параметры** (значок зубца шестеренки в правом верхнем углу страницы) и откройте страницу **Параметры** (как показано на следующем снимке экрана).

  ![Страница параметров](./readme-images/block-on-send-settings.png)

3. В разделе **Параметры приложения** на странице **Параметры** выберите пункт **Почта**.
4. На странице **Параметры** выберите **Общие**, а затем **Управление надстройками** (как показано на следующем снимке экрана).

 ![Страница управления надстройками](./readme-images/block-on-send-manage-addins.png)

5. На странице **Управление надстройками** щелкните значок ''+'' и выберите команду **Добавить из файла**. Выберите файл манифеста `Contoso Message Body Checker.xml`, включенный в проект. Нажмите кнопку **Далее**, а затем **Установить**. В заключение нажмите кнопку **OK**.
6. Повторите действие 5 для установки файла манифеста `Contoso Subject and CC Checker.xml`.
7. Вернитесь в представление ''Почта'' Outlook Web App.


## Запуск надстройки

### Проверка строк "Тема" и "Копия"

1. Создайте в Outlook Web App сообщение электронной почты. 
2. Оставьте строку темы пустой.
3. Укажите получателя в строке **Кому**. 
4. Нажмите кнопку **Отправить**. 

* В поле ''Копия'' будет добавлен адрес получателя копии. В данном примере это `Contoso@contoso.onmicrosoft.com`.
* Сообщение не будет отправлено, а на панели информации появится сообщение об ошибке, уведомляющее отправителя, что необходимо указать тему (как показано на следующем снимке экрана).  

 ![Панели информации с результатом проверки темы и копии](./readme-images/block-on-send-subject-cc-inforbar.png) 

6. Укажите тему.
7. Перед темой будет добавлен текст `[Checked]:`, и сообщение будет отправлено.

### Средство проверки текста сообщения.

1. Создайте в Outlook Web App сообщение электронной почты. 
2. В тексте сообщения введите `blockedword`, `blockedword1` или `blockedword2`. (Это массив запрещенных слов в файле app.js функции `checkBodyOnlyOnSendCallBack`).
3. Укажите получателя в строке **Кому**. 
5. Нажмите кнопку **Отправить**.  

* Сообщение не будет отправлено, так как его текст содержит запрещенные слова.  
* На панели информации появится сообщение об ошибке, уведомляющее отправителя о найденных запрещенных словах (как показано на следующем снимке экрана).  

 ![Панель информации с результатами проверки текста сообщения](./readme-images/block-on-send-body.png)

5. Чтобы отправить сообщение, удалите запрещенные слова.

## Вопросы и комментарии

Мы будем рады узнать ваше мнение об этом примере. Своими мыслями можете поделиться на вкладке *Issues* (Проблемы) этого репозитория.

Общие вопросы о разработке решений для Microsoft Office 365 следует задавать на сайте [Stack Overflow](http://stackoverflow.com/questions/tagged/office-js+API). Если ваш вопрос касается API JavaScript для Office, добавьте к нему теги [office-js] и [API].

## Дополнительные ресурсы

* [Документация по надстройкам Office](https://msdn.microsoft.com/en-us/library/office/jj220060.aspx)
* [Центр разработчиков Office](http://dev.office.com/)
* Другие примеры надстроек Office см. на странице [OfficeDev на Github](https://github.com/officedev).

## Авторские права
© Корпорация Майкрософт (Microsoft Corporation), 2016. Все права защищены.



Этот проект соответствует [Правилам поведения разработчиков открытого кода Майкрософт](https://opensource.microsoft.com/codeofconduct/). Дополнительные сведения см. в разделе [часто задаваемых вопросов о правилах поведения](https://opensource.microsoft.com/codeofconduct/faq/). Если у вас возникли вопросы или замечания, напишите нам по адресу [opencode@microsoft.com](mailto:opencode@microsoft.com).
